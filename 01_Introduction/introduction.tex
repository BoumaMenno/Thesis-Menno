\documentclass[../DC2017114Bouma.tex]{subfiles}
\begin{document}
\graphicspath{{01_Introduction/img/}}
\renewcommand{\chaptermark}[1]{\markboth{\thechapter.\ #1}{}}
\renewcommand{\sectionmark}[1]{\markright{#1}{}}
\cleartooddpage
\pagestyle{fancyreport}
\pagenumbering{arabic}

\chapter{Introduction}
\section{High performance physical interaction in robotics}
In many applications of mechanical systems physical interaction with the environment is necessary to function, particularly in robotics. Humanoid robots, quadrupeds, and industrial robots are some examples of robots that repeatedly interact with their environment. Straightforward control strategies that are available for these applications are limiting in performance. To avoid complexity of the controller, they often assume contact with their environment to happen at zero speed. This makes the robots less suitable for situations where speed is of significance, e.g., an industrial robot aiming to reach a certain throughput or a quadruped performing a trotting motion. High performance is desirable in such cases, and zero velocity contact limits this performance. Therefore it is clear that the field of robotics can benefit of control strategies that are capable of handling non-zero velocities. Such controllers, however, are considerably more complex than for zero velocity contact situations.

\begin{figure}[H]
\centering
\includegraphics[width=.5\textwidth]{quadruped.jpg}\caption{The quadruped of Virginia Tech is an example of a robot with physical interaction that can benefit from high performance control strategies. Especially for high speed trotting motions, one can imagine that non-zero velocity contact is essential.}\label{fig:quadrupedVT}
\end{figure}

When two bodies make physical contact at non-zero velocity, impact occurs. Impact is a complex physical event, that is characterized by very short durations, high force levels, high energy dissipation rates, and large accelerations and decelerations. Due to the small time scale at which impacts happen, the impact is often modeled by assuming that the change in velocity during impact happens due to an impulsive force, i.e., the velocity jump happens in zero time. Systems exhibiting such dynamics are often represented as \textit{nonsmooth}. In dynamics, the state doesn't necessarily have to be a smooth function of time, meaning that not all it's time-derivatives exist. Nonsmooth mechanical systems with impact are systems that have discontinuities in their state-evolution. Mechanical systems with unilateral constraints are an example of systems that can exhibit nonsmooth behavior, as they experience velocity jumps when their unilateral constraints are closed at non-zero velocities. Control strategies for such systems are necessary to achieve higher performance.

\section{Nonsmooth modeling frameworks}
Nonsmooth systems can be described by several mathematical frameworks, e.g., singularly perturbed systems, hybrid systems, complementarity systems and (measure-)differential inclusions \cite{Leine2004}. The singular perturbation framework approximates the nonsmooth behaviour using a singularly perturbed smooth system. In this way, the singularly perturbed system can be evaluated numerically using a single smooth differential equation. However, due to the smooth approximation extremely small time-steps are necessary which makes the system very stiff. More suitable for this are differential inclusions, which are applicable to systems with a discontinuous right-hand side but a time-continuous state-evolution (also called Filippov-systems \cite{Filippov1988}). A common example of Filippov-systems are systems experiencing friction. The differential inclusion gives a description of the nonsmooth dynamics in a single inclusion. However, mechanical systems with unilateral constraints and impact do not satisfy the requirement of having a time-continuous state-evolution. A measure-differential inclusion describes the continuous as well as the impulsive dynamics of a nonsmooth system \cite{Leine2008b}. In this way, measure-differential inclusions are suitable for systems with time-discontinuities in their state-evolution \cite{Moreau1988,Brogliato1999}. Using this approach the dynamics can be accurately integrated using the timestepping method \cite{Wouwa}. From a control point-of-view the complementarity framework is often considered. This framework describes nonsmoothness through a combination of differential equations and inequalities \cite{VanDerSchaft1998,Heemels1999}. In \cite{Glocker2001} the complementarity problem is used to describe mechanical systems with unilateral constraints. It plays a key role in mathematical programming, and several solutions for trajectory tracking using complementarity systems exist \cite{Bourgeot2005,Morarescu2010}. In recent years the hybrid systems framework has drawn more interest for solving the trajectory tracking problem of nonsmooth systems \cite{Hyun2014,Morris2009}. A hybrid system is a dynamical system that exhibits both continuous and discrete dynamics behaviour, where it switches (discrete behaviour) between several differential equations (continuous behaviour) \cite{Goebel2009}. According to \cite{Ding2011a}, the hybrid systems framework is suitable for the modeling of mechanical systems with unilateral constraints as well as robotics. In a hybrid dynamics model \textit{guard functions} are defined, which when activated will cause the dynamics to switch from one differential equation to another and possibly reinitialize the state. This makes it a very intuitive approach to the modeling of nonsmoothness. A known difficulty with this description however, is a phenomenon called Zeno-behaviour. One speaks of Zeno-behaviour when an infinite amount of guard activations happen in a finite time. A classic example is the bouncing ball. Measure-differential inclusions with a timestepping scheme would be more suitable in such a situation, because the timestep is able to skip the Zeno-behavior. An advantage of using the hybrid systems framework, is that it is a more intuitive description of the dynamics whereas measure-differential inclusions are more abstract. The stability analyses for these frameworks are well-developed, i.e., \cite{Ye1998,Lygeros2003,Goebel2009} for hybrid systems, \cite{Pereira2004,Brogliato2004,Leine2008} for measure differential inclusions, and \cite{Brogliato1999,Camlibel2006,Camlibel2007} for linear complementarity problems.

\section{Tracking control for nonsmooth systems}
Legged robotic systems account for a substantial part of the research done into the trajectory tracking control of mechanical systems with unilateral constraints. Many results in this area deal with the stability of periodic orbits of systems with impacts. In \cite{Raibert1984}, a first big step has been made into modeling and controlling a one-legged hopping robot. In this research, the energy-loss during impact is modeled through damping and coupling effects are modeled as perturbations. Other pioneering works can be found in \cite{Lebaudy1993,Michalska1996,Gregorio1997}. In \cite{Grizzle2001,Morris2009}, the hybrid framework is adopted to find stable walking gaits for biped robots. Using Poincar\'{e} maps, the stability of periodic orbits with discontinuities of under-actuated systems are analyzed. In this work, phases can be distinguished where the system is fully actuated and where the system is under-actuated. The fully actuated phase can then be used to stabilize the periodic trajectory despite the under-actuated phase. \cite{Ames2014} continues on this work, generating control laws using data of walking humans and in \cite{Reher2016} the energy-efficiency of generated walking gaits has been the focus. An example of a humanoid robot on which such controllers have been implemented is the HRP-4 \cite{HRP4}, which is depicted in Figure~\ref{fig:hrp4}. An extensive survey in the field of bipedal robotic walking can be found in \cite{Grizzle2014}. The analysis of stable walking gaits is applied to the MIT Cheetah in \cite{Hyun2014}, where a stability analysis and controller design is presented for the trot-running of a quadrupedal robot.  

\begin{figure}[H]
\centering
\includegraphics[width=.4\textwidth]{hrp4.jpg}\caption{The HRP-4 is a humanoid robot which has shown success in bipedal walking motions. Control laws as presented in \cite{Ames2014} and \cite{Reher2016} enable the stabilization of such walking gaits.}\label{fig:hrp4}
\end{figure}

There has been made considerable progress in the field of walking robots and billiards, but it is easy to think of a an example where nonperiodic trajectories are of interest. Under the assumption that the state trajectory jumps at the exact same time as the reference trajectory, the trajectory tracking problem for nonsmooth systems had been solved multiple times. The tracking problem for Lur'e type systems has been analyzed in \cite{VanDeWouw2008,Wouw2010}, using MDI's to describe nonsmooth and impulsive dynamics. This work uses the convergence property to provide a solution to the tracking problem, where the solution may be time-varying and exhibit state-jumps. In \cite{Bourgeot2005}, the passivity-based approach is used to solve the tracking control problem of complementarity Lagrangian systems. Asymptotic stability is achieved for Lagrangian systems with unilateral constraints. The same approach has been applied to the hybrid system framework in \cite{Naldi2013}, which results in a control law that can guarantee stability of a trajectory with multiple impacts. By embedding the reference trajectory with discontinuities into a set, Lyapunov tools can be used to analyze stability as in \cite{Sanfelice2011,Sanfelice2014}. In \cite{Posa2016} a stability analysis of systems with impacts and friction has been presented. The results are obtained using the measure-differential inclusion framework, resulting in a smooth control law. The planning and control of non-periodic bipedal locomotion with impacts and friction is discussed in \cite{Zhao2015a}.

In the prior discussed work, the tracking problem has been solved under the assumption that the jump of the state trajectory occurs at the same time-instant as the jump of the desired reference trajectory, i.e., in \cite{Naldi2013,Sanfelice2014,Posa2016}. In reality, especially in high velocity conditions, the time-instant of the state jump and trajectory jump diverge more often than not. In this case a phenomenon called \textit{peaking} occurs \cite{Biemond2013}. Spikes in the tracking error will arise around the jump times, which defy the notion of stability and are unfavorable when designing a stabilizing controller. Solutions exist for periodic orbits in \cite{Menini2001,Galeani2008}, where the results are compatible with a mismatch in reference jump-time and state jump-time for periodic trajectories with infinitely many state-jumps. Such trajectories are often found in so called \textit{Birkhoff Billiards} where the coefficient of restitution is 1. \cite{Forni2013} also presents results for billiards, applicable to more trajectories than the previous mentioned work. In \cite{Biemond2013,Biemond2016}, a novel definition of the tracking error is introduced, using a distance function which is not sensitive to jumps of the state and the reference trajectory. Lyapunov-based conditions for the global asymptotic stability of non-smooth trajectories have been derived. Another solution for the problem of a jump-time mismatch is proposed in \cite{Baumann2018}, in the form of a distance function similar to \cite{Biemond2013,Biemond2016} based on a quotient metric. When a state jump happens at different time than the reference jump, this approach applies the jump map to the reference to be able to compare the state to the reference. \cite{Kim2016} introduces a novel controller design using gluing functions to connect the start and end point of a jump in the state space. After gluing, the system can be considered a continuous or piecewise continuous function without state jumps. In \cite{Yang2017} a tracking error is defined by taking the smallest of two values: the ante-impact tracking error and post-impact tracking error.

\section{Reference spreading control}
In \cite{Saccon2014,Rijnen2015} a novel notion of error is introduced for systems with state jumps, by extending the reference trajectory segments over the entire domain of the state space, and considering the error between the reference trajectory and state trajectory that have encountered the same number of jumps. This notion of error is the basis for extending the sensitivity analysis introduced in \cite{Khalil1996} to the hybrid system framework. These results are then used to obtain a local approximation of the perturbed state dynamics. This analysis gives insight in how the system behaves under the presence of perturbations, which is useful during controller design. Experimental results for this control law are presented in \cite{Incremona2015}, where a simple 1-DOF robot arm performs an impacting trajectory using the control law proposed in \cite{Saccon2014}. In \cite{Rijnen2016} the sensitivity analysis for hybrid systems with state triggered jumps is used for a trajectory tracking control strategy on a hopping robotic leg model from \cite{Tsagarakis2013}. This control strategy is named \textit{reference spreading control} in \cite{Rijnen2017}, due to the extensions made on the reference trajectories in the notion of error. In \cite{Rijnen2017a} the reference spreading control law is used in simulations with an iCub robot. The iCub robot balances on one foot and keeps himself standing upright by making and breaking contact with a wall using on of his arms. Some snapshots of the motion are depicted in Figure~\ref{fig:rijnen2017}. As mentioned earlier, many available results work under the assumption that the exact impact time is known. This is extremely limiting during implementation of the control law. Using the reference spreading approach, the impact time of the state is allowed to deviate from that of the reference, making implementation of the control law in practical applications more viable while still allowing for state-jumps.

\begin{figure}[H]
\centering
\includegraphics[width=\textwidth]{rijnen2017.PNG}\caption{Snapshots of the motion the iCub robot makes in the simulation done in \cite{Rijnen2017a} using reference spreading control. The wrist of the arm is modeled as a point-contact, which makes contact with the wall at non-zero velocities.}\label{fig:rijnen2017}
\end{figure}

As is the case in the simulations with the iCub in Figure~\ref{fig:rijnen2017}, impacts are often modeled using a one-point contact between two bodies. However, in practice more complex geometries can make contact with each other. A more realistic contact is used in \cite{Zhao2015}, in which the foot strike of a humanoid bipedal robot is modeled using multiple impacts. One strike is modeled by a heel impact, a toe impact, a heel release, and finally a toe release, resulting in a more realistic model of the walking gait of the bipedal robot. In such a movement the order of impacts is known.

When considering a trajectory with multiple contacts closing at one time-instant, the problem becomes more complex. Imagine for example the iCub in \cite{Rijnen2017a} having a physically realistic geometry at the end of it's arm. The arm can first make a point contact, then a line contact, and finally a surface contact to make full contact with the wall. It can also track a trajectory where the surface of the arm makes a surface contact with the wall at one time-instant. Such events can be considered as multiple impacts happening at the same time-instant and are called \textit{simultaneous impacts}. One can imagine that at high velocities, a small perturbation can significantly change the behavior of a simultaneous impact. Instead of the expected single jump in the state, a perturbation can cause the state to have multiple jumps. Also the order of impacts of the several parts of the arm is unknown beforehand. In Figure~\ref{fig:simultaneous} a 2-dimensional representation of the wrist of the iCub robot is illustrated. This image clearly visualizes the effect a perturbation has on a trajectory with simultaneous impacts. The approach used in \cite{Zhao2015} is not suitable for these situations.

\begin{figure}[H]
\centering
\includegraphics[width=.45\textwidth]{simultaneous.eps}\caption{A 2-dimensional illustration of the end effector of the wrist of the iCub robot. On the left a nominal trajectory is illustrated (from top to bottom), where a simultaneous impact happens. The wrist immediately makes a line-contact with the surface. On the right the trajectory is perturbed, which results in two impacts instead of one.}\label{fig:simultaneous}
\end{figure}

The phenomenon of simultaneous impacts is first introduced in \cite{Chen2018a}, where the first step is taken into solving the trajectory tracking problem for such impacts. A hybrid system framework is used to model the impacts, where multiple guards can be activated at once. The reference spreading control in \cite{Rijnen2016,Rijnen2017} and the sensitivity analysis to approximate a system's behavior around trajectories with single guard activation, introduced in \cite{Saccon2014}, are extended to be suitable for simultaneous guard activation. The results of the sensitivity analyses are used to find suitable gains for the reference spreading control law. However, these results do not consider friction. In addition to an impulse perpendicular to the impact-surface, taking friction into account will result in a tangential impulse. Also the release phase is not considered in the work of \cite{Chen2018a}. During the release phase there is no discontinuity in the state-evolution, only a change in the number of active constraints on the system. Therefore, the aim of this research is to investigate both stability of impacts including friction and the release phase of contact.

\section{Contribution}

\subsection*{Simultaneous impacts with friction}
Friction elements are often disregarded when analyzing impacts. However, to set up a unifying theory, friction elements should not be ignored. Tangential impulses can have a considerable effect on a system's dynamics. The impact laws used in the work of \cite{Chen2018a} can be extended using one of the several available friction laws \cite{Leine2008}. When impact laws are supplemented with a tangential element, this is often done using a Coulomb friction law \cite{Glocker2014a}. Besides the tangential impulse, also a Filippov-like discontinuity will be present due to Coulomb friction. Also in this work a Coulomb friction law is used, which can lead to more accurate models and controllers for mechanical systems with unilateral constraints.\\\\
\textbf{Research Objective:}\\
\textit{Find a model suitable to describe mechanical systems with unilateral constraints and spatial friction. The positive homogenization's notation and sensitivity analysis shall be adjusted to be compatible with such models.}

\subsection*{Simultaneous impacts with release}
In \cite{Rijnen2016} and \cite{Rijn2016}, the release phase of a system with a reference spreading controller has been extensively researched. However, these results only include single guard activation. The release phase for multiple guard activation is not yet investigated. In \cite{Chen2018a}, only a single contact is simulated for this reason. Extending the sensitivity analysis in \cite{Chen2018a} to be suitable for simultaneous releases would make it possible to simulate and control one trajectory with several simultaneous contacts and releases.\\\\
\textbf{Research Objective:}\\
\textit{Adjusting the positive homogenization, such that it is suitable for input-dependent guard functions. This will result in a positive homogenization suitable for trajectories that contain a releasing motion.}
\section{Report outline}
First, the modeling of mechanical systems with unilateral constraints and spatial friction is discussed in Chapter~\ref{ch:model}. Here the general dynamics of a mechanical system including contact and friction laws are derived, eventually resulting in a hybrid system with impulsive effects. Then, in Chapter~\ref{ch:order} a tracking control strategy for hybrid systems with ordered state-input-triggered events is presented. In Chapter~\ref{ch:simult} this tracking control strategy is extended to trajectories involving simultaneous impacts. After this an example of a mechanical system with unilateral constraints and spatial friction is given in Chapter~\ref{ch:vali}, which is used for a numerical validation of the presented control strategy. Finally, in Chapter~\ref{ch:concl}, conclusions are drawn and recommendations for future research are provided.

\end{document}